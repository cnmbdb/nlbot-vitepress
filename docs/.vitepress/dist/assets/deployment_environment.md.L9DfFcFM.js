import{_ as a,o as i,c as n,ae as e}from"./chunks/framework.BD9pLfSD.js";const k=JSON.parse('{"title":"环境配置","description":"","frontmatter":{},"headers":[],"relativePath":"deployment/environment.md","filePath":"deployment/environment.md"}'),l={name:"deployment/environment.md"};function t(p,s,o,h,r,d){return i(),n("div",null,[...s[0]||(s[0]=[e(`<h1 id="环境配置" tabindex="-1">环境配置 <a class="header-anchor" href="#环境配置" aria-label="Permalink to &quot;环境配置&quot;">​</a></h1><p>本文档介绍 TGNL Admin 项目的环境配置。</p><h2 id="环境变量" tabindex="-1">环境变量 <a class="header-anchor" href="#环境变量" aria-label="Permalink to &quot;环境变量&quot;">​</a></h2><h3 id="数据库配置" tabindex="-1">数据库配置 <a class="header-anchor" href="#数据库配置" aria-label="Permalink to &quot;数据库配置&quot;">​</a></h3><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DB_HOST=db              # 数据库主机</span></span>
<span class="line"><span>DB_PORT=3306            # 数据库端口</span></span>
<span class="line"><span>DB_USER=root            # 数据库用户名</span></span>
<span class="line"><span>DB_PASSWORD=your_password  # 数据库密码</span></span>
<span class="line"><span>DB_NAME=tgnl            # 数据库名称</span></span></code></pre></div><h3 id="应用配置" tabindex="-1">应用配置 <a class="header-anchor" href="#应用配置" aria-label="Permalink to &quot;应用配置&quot;">​</a></h3><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>PORT=3000               # 应用端口</span></span>
<span class="line"><span>APP_BASE_PATH=/admin    # 应用基础路径</span></span>
<span class="line"><span>APP_HOST=app            # 应用主机</span></span></code></pre></div><h3 id="bot-配置" tabindex="-1">Bot 配置 <a class="header-anchor" href="#bot-配置" aria-label="Permalink to &quot;Bot 配置&quot;">​</a></h3><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>BOT_TOKEN=your_bot_token  # Telegram Bot Token</span></span></code></pre></div><h3 id="时区配置" tabindex="-1">时区配置 <a class="header-anchor" href="#时区配置" aria-label="Permalink to &quot;时区配置&quot;">​</a></h3><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>TZ=Asia/Shanghai        # 时区设置</span></span></code></pre></div><h2 id="config-txt-配置" tabindex="-1">config.txt 配置 <a class="header-anchor" href="#config-txt-配置" aria-label="Permalink to &quot;config.txt 配置&quot;">​</a></h2><p>Bot 配置文件位于 <code>nl-2333/config.txt</code>：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>TOKEN=your_bot_token</span></span>
<span class="line"><span>energy_pool_api=http://host.docker.internal:3000</span></span>
<span class="line"><span>username=your_username</span></span>
<span class="line"><span>password=your_password</span></span></code></pre></div><h3 id="配置项说明" tabindex="-1">配置项说明 <a class="header-anchor" href="#配置项说明" aria-label="Permalink to &quot;配置项说明&quot;">​</a></h3><ul><li><strong>TOKEN</strong>: Telegram Bot Token（从 @BotFather 获取）</li><li><strong>energy_pool_api</strong>: 能量池 API 地址</li><li><strong>username</strong>: 能量池账号用户名</li><li><strong>password</strong>: 能量池账号密码</li></ul><h2 id="wordpress-api-配置-可选" tabindex="-1">WordPress API 配置（可选） <a class="header-anchor" href="#wordpress-api-配置-可选" aria-label="Permalink to &quot;WordPress API 配置（可选）&quot;">​</a></h2><p>如果需要使用 WordPress API：</p><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>WORDPRESS_URL=https://your-wordpress-site.com</span></span>
<span class="line"><span>WORDPRESS_USERNAME=your_username</span></span>
<span class="line"><span>WORDPRESS_APP_PASSWORD=your_app_password</span></span>
<span class="line"><span>WORDPRESS_PRODUCT_ID=your_product_id</span></span></code></pre></div><h2 id="授权配置-可选" tabindex="-1">授权配置（可选） <a class="header-anchor" href="#授权配置-可选" aria-label="Permalink to &quot;授权配置（可选）&quot;">​</a></h2><div class="language-env vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">env</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ORDER_NUMBER=your_order_number</span></span>
<span class="line"><span>SERVER_IP=your_server_ip</span></span></code></pre></div><h2 id="环境变量优先级" tabindex="-1">环境变量优先级 <a class="header-anchor" href="#环境变量优先级" aria-label="Permalink to &quot;环境变量优先级&quot;">​</a></h2><ol><li><code>.env</code> 文件中的配置</li><li>系统环境变量</li><li>默认值</li></ol><h2 id="配置验证" tabindex="-1">配置验证 <a class="header-anchor" href="#配置验证" aria-label="Permalink to &quot;配置验证&quot;">​</a></h2><h3 id="检查环境变量" tabindex="-1">检查环境变量 <a class="header-anchor" href="#检查环境变量" aria-label="Permalink to &quot;检查环境变量&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看所有环境变量</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看特定服务的环境变量</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> env</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DB_</span></span></code></pre></div><h3 id="测试数据库连接" tabindex="-1">测试数据库连接 <a class="header-anchor" href="#测试数据库连接" aria-label="Permalink to &quot;测试数据库连接&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">const mysql = require(&#39;mysql2&#39;);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">const connection = mysql.createConnection({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  host: process.env.DB_HOST,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  port: process.env.DB_PORT,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  user: process.env.DB_USER,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  password: process.env.DB_PASSWORD,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  database: process.env.DB_NAME</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">});</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">connection.connect((err) =&gt; {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  if (err) console.error(&#39;连接失败:&#39;, err);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  else console.log(&#39;连接成功&#39;);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  connection.end();</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">});</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span></code></pre></div><h2 id="配置更新" tabindex="-1">配置更新 <a class="header-anchor" href="#配置更新" aria-label="Permalink to &quot;配置更新&quot;">​</a></h2><h3 id="更新-env-文件" tabindex="-1">更新 .env 文件 <a class="header-anchor" href="#更新-env-文件" aria-label="Permalink to &quot;更新 .env 文件&quot;">​</a></h3><ol><li>编辑 <code>.env</code> 文件</li><li>重启相关服务：</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app</span></span></code></pre></div><h3 id="更新-config-txt" tabindex="-1">更新 config.txt <a class="header-anchor" href="#更新-config-txt" aria-label="Permalink to &quot;更新 config.txt&quot;">​</a></h3><ol><li>编辑 <code>nl-2333/config.txt</code></li><li>重启 bot 服务：</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bot</span></span></code></pre></div><h2 id="安全建议" tabindex="-1">安全建议 <a class="header-anchor" href="#安全建议" aria-label="Permalink to &quot;安全建议&quot;">​</a></h2><ol><li><p><strong>不要提交敏感信息</strong></p><ul><li>将 <code>.env</code> 添加到 <code>.gitignore</code></li><li>不要将包含密码的文件提交到 Git</li></ul></li><li><p><strong>使用强密码</strong></p><ul><li>数据库密码应足够复杂</li><li>定期更换密码</li></ul></li><li><p><strong>限制访问</strong></p><ul><li>数据库端口仅内部访问</li><li>使用防火墙限制外部访问</li></ul></li><li><p><strong>环境隔离</strong></p><ul><li>开发、测试、生产环境使用不同的配置</li><li>不要在生产环境使用开发配置</li></ul></li></ol><h2 id="相关文档" tabindex="-1">相关文档 <a class="header-anchor" href="#相关文档" aria-label="Permalink to &quot;相关文档&quot;">​</a></h2><ul><li><a href="/deployment/docker.html">Docker 部署</a></li><li><a href="/deployment/troubleshooting.html">故障排查</a></li></ul>`,39)])])}const g=a(l,[["render",t]]);export{k as __pageData,g as default};
